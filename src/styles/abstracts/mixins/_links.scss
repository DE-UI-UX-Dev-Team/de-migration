@use "sass:map"; 
@use "sass:string";

@use '../../abstracts/base' as *;
@use '../../abstracts/tokens' as *;
@use '../functions/string-replace.scss' as *;

@mixin getLinksOnColorBg ( $targetBackgroundType ) { 
     
    $backgroundClasses: ();

    @if( $targetBackgroundType == "dark-backgrounds" ) {  
        $targetBackgroundType: "dark-bg";
        $backgroundClasses: $darkBackgroundClasses;  
    } 
    @else if( $targetBackgroundType == "light-backgrounds" ) {
        $targetBackgroundType: "light-bg";
        $backgroundClasses: (""); // Placeholder because we only need the loop to run once
    } 
    @else {
        $backgroundClasses: $alertBackgroundClasses; 
    }

    @each $bgClass in $backgroundClasses { 
        
        $suffix: "drk-bg";  
        $bgSelector: "[class*=#{$bgClass}] ";

        @if $targetBackgroundType == "light-bg" { 
            $suffix: "lgt-bg";  
            $bgSelector: "";
        }

        @if $bgClass == "bg--success-background" or 
            $bgClass == "bg--warning-background" or 
            $bgClass == "bg--error-background" or 
            $bgClass == "bg--info-background" 
        {
            $suffix: str-replace( str-replace($bgClass, "bg--", ""), "-background", "-bg" );  
        }

        @each $backgroundType, $palette in map.get($linksOnContrastingBg, #{$active-theme}) {   
            @if( 
                $backgroundType == $targetBackgroundType or
                $backgroundType == $suffix
            ) {

                @each $link, $states in $palette { 
                    @each $state, $properties in $states {
                        @if $link == "default-links" {
                            @if $state == "default" {
                                #{$bgSelector}a, 
                                #{$bgSelector}a i {
                                    @each $property, $value in $properties{ 
                                        @if $value != null {
                                            #{$property}: #{$value};
                                        }
                                    }
                                } 
                            }
                            @else if $state == "disabled" {
                                #{$bgSelector}a[#{$state}], 
                                #{$bgSelector}a.#{$state} {
                                    @each $property, $value in $properties{ 
                                        @if $value != null {
                                            #{$property}: #{$value};
                                        }
                                    }
                                } 
                            }
                            @else{
                                #{$bgSelector}a:#{$state} {
                                    @each $property, $value in $properties{
                                        @if $value != null {
                                            #{$property}: #{$value};
                                        }
                                    }
                                } 
                            }
                        }
                        @if $link == "group-links"{
                            @if $state == "default" {
                                #{$bgSelector}ol a,
                                #{$bgSelector}ul a,
                                #{$bgSelector}dl a,
                                #{$bgSelector}ol a i,
                                #{$bgSelector}ul a i,
                                #{$bgSelector}dl a i  {
                                    @each $property, $value in $properties{
                                        @if $value != null {
                                            #{$property}: #{$value};
                                        }
                                    }
                                } 
                            }
                            @else if $state == "disabled" {
                                #{$bgSelector}ol a[#{$state}],
                                #{$bgSelector}li a[#{$state}],
                                #{$bgSelector}dl a[#{$state}], 
                                #{$bgSelector}ol a.#{$state},
                                #{$bgSelector}li a.#{$state},
                                #{$bgSelector}dl a.#{$state} {
                                    @each $property, $value in $properties{
                                        @if $value != null {
                                            #{$property}: #{$value};
                                        }
                                    }
                                }
                            }
                            @else{
                                #{$bgSelector}ol a:#{$state},
                                #{$bgSelector}li a:#{$state},
                                #{$bgSelector}dl a:#{$state}{
                                    @each $property, $value in $properties{
                                        @if $value != null {
                                            #{$property}: #{$value};
                                        }
                                    }
                                }
                            }
                        }
                        @if $link == "email-phone-links"{
                            @if $state == "default" {
                                #{$bgSelector}a[href^="mailto:"],
                                #{$bgSelector}a[href^="tel:"]{
                                    @each $property, $value in $properties{
                                        @if $value != null {
                                            #{$property}: #{$value};
                                        }
                                    }
                                } 
                            }
                            @else if $state == "disabled" {
                                #{$bgSelector}a[href^="mailto:"][#{$state}],
                                #{$bgSelector}a[href^="tel:"][#{$state}], 
                                #{$bgSelector}a[href^="mailto:"].#{$state},
                                #{$bgSelector}a[href^="tel:"].#{$state} {
                                    @each $property, $value in $properties{
                                        @if $value != null {
                                            #{$property}: #{$value};
                                        }
                                    }
                                }
                            }
                            @else{
                                #{$bgSelector}a[href^="mailto:"]:#{$state},
                                #{$bgSelector}a[href^="tel:"]:#{$state}{
                                    @each $property, $value in $properties{
                                        @if $value != null {
                                            #{$property}: #{$value};
                                        }
                                    }
                                }
                            }
                        }
                    } // End loop - properties

                } // End loop - palette
            } // End if - targetBackgroundType
        } // End loop - $buttonsOnContrastingBg
    } // End loop - backgroundClasses
} // End mixin